{"ast":null,"code":"import _slicedToArray from\"/Users/alexey/Desktop/dev/react-mesto-auth/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useEffect,useState}from\"react\";import CurrentUserContext from\"../../contexts/CurrentUserContext\";import api from\"../../utils/api\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Card(_ref){var card=_ref.card,onCardClick=_ref.onCardClick,onCardDelete=_ref.onCardDelete;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLiked=_useState2[0],setIsLiked=_useState2[1];var _useState3=useState(card.likes.length),_useState4=_slicedToArray(_useState3,2),count=_useState4[0],setCount=_useState4[1];var currentUser=useContext(CurrentUserContext);var isOwn=card.owner._id===currentUser._id;useEffect(function(){setIsLiked(card.likes.some(function(el){return currentUser._id===el._id;}));},[card.likes,currentUser._id]);function handleCardLike(){if(isLiked){api.removeLike(card._id).then(function(res){setIsLiked(false);setCount(res.likes.length);}).catch(function(err){return console.error(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u0441\\u043D\\u044F\\u0442\\u044C \\u043B\\u0430\\u0439\\u043A: \".concat(err));});}else{api.addLike(card._id).then(function(res){setIsLiked(true);setCount(res.likes.length);}).catch(function(err){return console.error(\"\\u041D\\u0435 \\u0443\\u0434\\u0430\\u043B\\u043E\\u0441\\u044C \\u043F\\u043E\\u0441\\u0442\\u0430\\u0432\\u0438\\u0442\\u044C \\u043B\\u0430\\u0439\\u043A: \".concat(err));});}}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"img\",{className:\"gallery__photo\",src:card.link,alt:card.name,onClick:function onClick(){return onCardClick(card);}}),isOwn&&/*#__PURE__*/_jsx(\"button\",{className:\"gallery__button-delete\",type:\"button\",title:\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C!\",\"aria-label\":\"\\u0423\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C!\",onClick:function onClick(){return onCardDelete(card._id);}}),/*#__PURE__*/_jsxs(\"div\",{className:\"gallery__info\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"gallery__title\",children:card.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"gallery__like\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"gallery__button-like \".concat(isLiked?'gallery__button-like_active':''),type:\"button\",title:\"\\u041B\\u0430\\u0439\\u043A!\",\"aria-label\":\"\\u041B\\u0430\\u0439\\u043A!\",onClick:handleCardLike}),/*#__PURE__*/_jsx(\"span\",{className:\"gallery__button-like-counter\",children:count})]})]})]});}","map":{"version":3,"names":["useContext","useEffect","useState","CurrentUserContext","api","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Card","_ref","card","onCardClick","onCardDelete","_useState","_useState2","_slicedToArray","isLiked","setIsLiked","_useState3","likes","length","_useState4","count","setCount","currentUser","isOwn","owner","_id","some","el","handleCardLike","removeLike","then","res","catch","err","console","error","concat","addLike","children","className","src","link","alt","name","onClick","type","title"],"sources":["/Users/alexey/Desktop/dev/react-mesto-auth/src/components/Card/Card.js"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport CurrentUserContext from \"../../contexts/CurrentUserContext\";\nimport api from \"../../utils/api\";\n\nexport default function Card({ card, onCardClick, onCardDelete }) {\n\n  const [isLiked, setIsLiked] = useState(false);\n  const [count, setCount] = useState(card.likes.length);\n\n  const currentUser = useContext(CurrentUserContext);\n  const isOwn = card.owner._id === currentUser._id;\n\n  useEffect(() => {\n    setIsLiked(card.likes.some(el => currentUser._id === el._id))\n  }, [card.likes, currentUser._id]);\n\n  function handleCardLike() {\n    if (isLiked) {\n      api.removeLike(card._id)\n        .then(res => {\n          setIsLiked(false)\n          setCount(res.likes.length)\n        })\n        .catch((err) => console.error(`Не удалось снять лайк: ${err}`));\n    } else {\n      api.addLike(card._id)\n        .then(res => {\n          setIsLiked(true)\n          setCount(res.likes.length)\n        })\n        .catch((err) => console.error(`Не удалось поставить лайк: ${err}`));\n    }\n  }\n\n  return (\n    <>\n      <img className=\"gallery__photo\" src={card.link} alt={card.name} onClick={() => onCardClick(card)} />\n      {isOwn && <button className=\"gallery__button-delete\" type=\"button\" title=\"Удалить!\" aria-label=\"Удалить!\" onClick={() => onCardDelete(card._id)} />}\n\n      <div className=\"gallery__info\">\n        <h2 className=\"gallery__title\">{card.name}</h2>\n        <div className=\"gallery__like\">\n          <button\n            className={`gallery__button-like ${isLiked ? 'gallery__button-like_active' : ''}`}\n            type=\"button\"\n            title=\"Лайк!\"\n            aria-label=\"Лайк!\"\n            onClick={handleCardLike}\n          />\n          <span className=\"gallery__button-like-counter\">{count}</span>\n        </div>\n      </div>\n    </>\n  )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}